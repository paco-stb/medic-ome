<!DOCTYPE html>
<html lang="fr">
<head>
Â  Â  <meta charset="UTF-8">
Â  Â  <meta name="viewport" content="width=device-width, initial-scale=1.0">
Â  Â  <title>Medicome</title>
Â  Â Â 
Â  Â  <link rel="canonical" href="https://medicome.fr/" />
Â  Â  <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ğŸ©º</text></svg>">
Â  Â  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
Â  Â  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
Â  Â Â 
Â  Â  <style>
Â  Â  Â  Â  /* ================= STYLE CHROME / DARK GLOSS ================= */
Â  Â  Â  Â  :root {
Â  Â  Â  Â  Â  --bg-dark: #020b16;
Â  Â  Â  Â  Â  --bg-light: #1e3c72;
Â  Â  Â  Â  Â  --glass-bg: rgba(13, 25, 48, 0.75);
Â  Â  Â  Â  Â  --glass-border: rgba(100, 200, 255, 0.15);
Â  Â  Â  Â  Â  --accent: #00d2ff;
Â  Â  Â  Â  Â  --accent-glow: rgba(0, 210, 255, 0.4);
Â  Â  Â  Â  Â  --text-main: #ffffff;
Â  Â  Â  Â  Â  --text-muted: #b0c4de;
Â  Â  Â  Â  Â  --success: #00ff9d;
Â  Â  Â  Â  Â  --error: #ff4d4d;
Â  Â  Â  Â  Â  --info: #60a5fa;
Â  Â  Â  Â  }

Â  Â  Â  Â  /* RESET & BASE */
Â  Â  Â  Â  * { box-sizing: border-box; margin: 0; padding: 0; scroll-behavior: smooth; }
Â  Â  Â  Â Â 
Â  Â  Â  Â  body {
Â  Â  Â  Â  Â  font-family: 'Inter', sans-serif;
Â  Â  Â  Â  Â  background: radial-gradient(circle at 50% 0%, var(--bg-light), var(--bg-dark) 80%);
Â  Â  Â  Â  Â  background-attachment: fixed;
Â  Â  Â  Â  Â  color: var(--text-main);
Â  Â  Â  Â  Â  min-height: 100vh;
Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  flex-direction: column;
Â  Â  Â  Â  }

Â  Â  Â  Â  /* HEADER */
Â  Â  Â  Â  header {
Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  justify-content: space-between;
Â  Â  Â  Â  Â  padding: 10px 24px;
Â  Â  Â  Â  Â  background: rgba(2, 11, 22, 0.8);
Â  Â  Â  Â  Â  backdrop-filter: blur(15px);
Â  Â  Â  Â  Â  -webkit-backdrop-filter: blur(15px);
Â  Â  Â  Â  Â  align-items: center;
Â  Â  Â  Â  Â  border-bottom: 1px solid var(--glass-border);
Â  Â  Â  Â  Â  position: sticky; top: 0; z-index: 100;
Â  Â  Â  Â  Â  box-shadow: 0 4px 20px rgba(0,0,0,0.5);
Â  Â  Â  Â  }

Â  Â  Â  Â  .brand {Â 
Â  Â  Â  Â  Â  Â  display: flex; align-items: center; gap: 12px;Â 
Â  Â  Â  Â  Â  Â  cursor: pointer; /* Sera gÃ©rÃ© par JS pour le lien */
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .logo-img {
Â  Â  Â  Â  Â  Â  height: 50px;Â 
Â  Â  Â  Â  Â  Â  width: auto;
Â  Â  Â  Â  Â  Â  filter: drop-shadow(0 0 8px var(--accent-glow));
Â  Â  Â  Â  Â  Â  transition: transform 0.3s;
Â  Â  Â  Â  }
Â  Â  Â  Â  .brand:hover .logo-img { transform: scale(1.05); }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .top-right { display:flex; gap:12px; align-items:center; flex-wrap:wrap; }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .pseudo {Â 
Â  Â  Â  Â  Â  Â  color:var(--accent); font-weight:600; padding:6px 12px;Â 
Â  Â  Â  Â  Â  Â  background: rgba(0, 210, 255, 0.05);Â 
Â  Â  Â  Â  Â  Â  border: 1px solid var(--glass-border);
Â  Â  Â  Â  Â  Â  border-radius:20px; cursor:pointer; font-size: 14px;Â 
Â  Â  Â  Â  }

Â  Â  Â  Â  /* BUTTONS & LINKS */
Â  Â  Â  Â  .link {
Â  Â  Â  Â  Â  background: rgba(255,255,255,0.03);
Â  Â  Â  Â  Â  border:1px solid rgba(255,255,255,0.1);
Â  Â  Â  Â  Â  color: var(--text-muted);
Â  Â  Â  Â  Â  padding:8px 16px;
Â  Â  Â  Â  Â  border-radius:8px;
Â  Â  Â  Â  Â  cursor:pointer;
Â  Â  Â  Â  Â  transition:all 0.3s;
Â  Â  Â  Â  Â  font-size:14px;
Â  Â  Â  Â  }
Â  Â  Â  Â  .link:hover {Â 
Â  Â  Â  Â  Â  Â  background: rgba(255,255,255,0.1);Â 
Â  Â  Â  Â  Â  Â  color: white;Â 
Â  Â  Â  Â  Â  Â  border-color: var(--accent);
Â  Â  Â  Â  Â  Â  box-shadow: 0 0 10px var(--accent-glow);
Â  Â  Â  Â  }

Â  Â  Â  Â  /* CARDS */
Â  Â  Â  Â  main { flex:1; max-width:1000px; width:100%; margin:0 auto; padding:30px 20px; display:flex; flex-direction:column; align-items:center; }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .card {Â 
Â  Â  Â  Â  Â  Â  background: var(--glass-bg);Â 
Â  Â  Â  Â  Â  Â  backdrop-filter: blur(12px);
Â  Â  Â  Â  Â  Â  -webkit-backdrop-filter: blur(12px);
Â  Â  Â  Â  Â  Â  padding:32px;Â 
Â  Â  Â  Â  Â  Â  border-radius:20px;Â 
Â  Â  Â  Â  Â  Â  box-shadow: 0 15px 35px rgba(0,0,0,0.6), inset 0 0 0 1px var(--glass-border);Â 
Â  Â  Â  Â  Â  Â  margin-bottom:16px; width:100%; max-width:600px;Â 
Â  Â  Â  Â  Â  Â  transition: transform 0.3s ease;
Â  Â  Â  Â  Â  Â  animation: fadeIn 0.5s ease-out;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .card h2 { margin-bottom:20px; font-size:26px; text-align:center; color: white; text-shadow: 0 2px 4px rgba(0,0,0,0.5); }
Â  Â  Â  Â  .card h3 { margin-bottom:16px; font-size:22px; text-align:center; color: var(--accent); }

Â  Â  Â  Â  /* INPUTS */
Â  Â  Â  Â  .input, select, textarea {Â 
Â  Â  Â  Â  Â  Â  width:100%; padding:14px; border-radius:10px;Â 
Â  Â  Â  Â  Â  Â  border:1px solid rgba(255,255,255,0.15);Â 
Â  Â  Â  Â  Â  Â  background: rgba(0,0,0,0.3);Â 
Â  Â  Â  Â  Â  Â  color: var(--text-main);Â 
Â  Â  Â  Â  Â  Â  margin-top:8px; margin-bottom:12px; font-size:14px;Â 
Â  Â  Â  Â  Â  Â  transition:all 0.3s; font-family: 'Inter', sans-serif;
Â  Â  Â  Â  }
Â  Â  Â  Â  textarea { resize: vertical; min-height: 100px; }
Â  Â  Â  Â  .input:focus, select:focus, textarea:focus {Â 
Â  Â  Â  Â  Â  Â  outline:none; border-color:var(--accent);Â 
Â  Â  Â  Â  Â  Â  background: rgba(0,0,0,0.5);Â 
Â  Â  Â  Â  Â  Â  box-shadow: 0 0 15px var(--accent-glow);
Â  Â  Â  Â  }

Â  Â  Â  Â  /* ACTION BUTTONS */
Â  Â  Â  Â  .btn {Â 
Â  Â  Â  Â  Â  Â  background: linear-gradient(135deg, #0072ff 0%, #00c6ff 100%);
Â  Â  Â  Â  Â  Â  border:none; padding:14px 24px; border-radius:12px;Â 
Â  Â  Â  Â  Â  Â  color: #000; cursor:pointer; font-weight:700; font-size:15px;Â 
Â  Â  Â  Â  Â  Â  transition:all 0.3s;Â 
Â  Â  Â  Â  Â  Â  box-shadow: 0 4px 15px rgba(0, 114, 255, 0.4);
Â  Â  Â  Â  Â  Â  text-transform: uppercase;
Â  Â  Â  Â  Â  Â  letter-spacing: 0.5px;
Â  Â  Â  Â  }
Â  Â  Â  Â  .btn:hover {Â 
Â  Â  Â  Â  Â  Â  transform:translateY(-2px);Â 
Â  Â  Â  Â  Â  Â  box-shadow: 0 6px 20px rgba(0, 114, 255, 0.6), inset 0 0 0 2px rgba(255,255,255,0.3);
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .btn-success { background: linear-gradient(135deg, #00b09b 0%, #96c93d 100%); color: #022015; box-shadow: 0 4px 15px rgba(0, 176, 155, 0.4); }
Â  Â  Â  Â  .btn-success:hover { box-shadow: 0 6px 20px rgba(0, 176, 155, 0.6); }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .btn-error { background: linear-gradient(135deg, #cb2d3e 0%, #ef473a 100%); color: white; box-shadow: 0 4px 15px rgba(203, 45, 62, 0.4); }
Â  Â  Â  Â  .btn-error:hover { box-shadow: 0 6px 20px rgba(203, 45, 62, 0.6); }

Â  Â  Â  Â  .btn-code {Â 
Â  Â  Â  Â  Â  Â  background: transparent !important;Â 
Â  Â  Â  Â  Â  Â  border: 1px solid var(--accent) !important;Â 
Â  Â  Â  Â  Â  Â  color: var(--accent) !important;
Â  Â  Â  Â  Â  Â  box-shadow: none !important;
Â  Â  Â  Â  }
Â  Â  Â  Â  .btn-code:hover { background: rgba(0, 210, 255, 0.1) !important; box-shadow: 0 0 15px var(--accent-glow) !important; }

Â  Â  Â  Â  .btn-back {
Â  Â  Â  Â  Â  Â  background: rgba(255, 255, 255, 0.1); color: #ccc;
Â  Â  Â  Â  Â  Â  border: 1px solid rgba(255, 255, 255, 0.2); padding: 10px 20px;
Â  Â  Â  Â  Â  Â  border-radius: 10px; cursor: pointer; font-size: 14px; font-weight: 600;
Â  Â  Â  Â  Â  Â  transition: all 0.2s;
Â  Â  Â  Â  }
Â  Â  Â  Â  .btn-back:hover { background: rgba(255, 255, 255, 0.2); color: white; }

Â  Â  Â  Â  /* ELEMENTS */
Â  Â  Â  Â  .center { text-align:center; display:flex; flex-direction:column; align-items:center; }
Â  Â  Â  Â  .button-group { display:flex; gap:16px; justify-content:center; flex-wrap:wrap; margin-top:12px; width: 100%; }
Â  Â  Â  Â  .small { opacity:0.6; font-size:13px; color:var(--text-muted); margin-top:12px; text-align:center; }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .question-text {Â 
Â  Â  Â  Â  Â  Â  font-size:22px; text-align:center; line-height:1.6; padding:24px;Â 
Â  Â  Â  Â  Â  Â  background: linear-gradient(90deg, rgba(0,210,255,0.05) 0%, rgba(0,210,255,0) 100%);
Â  Â  Â  Â  Â  Â  border-radius:12px; border-left:4px solid var(--accent);Â 
Â  Â  Â  Â  Â  Â  word-break:break-word; width: 100%; margin-bottom: 20px;
Â  Â  Â  Â  Â  Â  box-shadow: inset 0 0 20px rgba(0,0,0,0.2);
Â  Â  Â  Â  }

Â  Â  Â  Â  /* REVIEWS SECTION */
Â  Â  Â  Â  .reviews-container {
Â  Â  Â  Â  Â  Â  display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 20px; width: 100%;
Â  Â  Â  Â  }
Â  Â  Â  Â  .review-card {
Â  Â  Â  Â  Â  Â  background: rgba(0,0,0,0.3); border: 1px solid rgba(255,255,255,0.1);
Â  Â  Â  Â  Â  Â  border-radius: 12px; padding: 15px; text-align: left;
Â  Â  Â  Â  }
Â  Â  Â  Â  .review-header { display: flex; align-items: center; gap: 10px; margin-bottom: 8px; }
Â  Â  Â  Â  .review-avatar { width: 30px; height: 30px; background: var(--accent); border-radius: 50%; display:flex; align-items:center; justify-content:center; font-weight:bold; color:black; font-size:12px;}
Â  Â  Â  Â  .review-name { font-weight: 600; font-size: 14px; color: white; }
Â  Â  Â  Â  .review-stars { color: #FFD700; font-size: 12px; }
Â  Â  Â  Â  .review-text { font-size: 13px; color: var(--text-muted); font-style: italic; }

Â  Â  Â  Â  /* GLOSSAIRE */
Â  Â  Â  Â  .glossary-wrapper { display: flex; align-items: flex-start; gap: 20px; width: 100%; max-width: 1000px; position: relative; }
Â  Â  Â  Â  .alphabet-sidebar { position: sticky; top: 100px; display: flex; flex-direction: column; gap: 2px; background: rgba(0, 0, 0, 0.4); padding: 10px; border-radius: 20px; border: 1px solid var(--glass-border); max-height: 80vh; overflow-y: auto; flex-shrink: 0; }
Â  Â  Â  Â  .alpha-link { color: var(--text-muted); text-decoration: none; font-size: 12px; font-weight: 700; padding: 2px 8px; border-radius: 4px; transition: all 0.2s; text-align: center; }
Â  Â  Â  Â  .alpha-link:hover { color: white; background: rgba(255,255,255,0.1); }
Â  Â  Â  Â  .alpha-link.active { color: var(--accent); background: rgba(0, 210, 255, 0.1); }
Â  Â  Â  Â  .alpha-link.disabled { opacity: 0.2; cursor: default; pointer-events: none; }
Â  Â  Â  Â  .glossary-content { flex: 1; width: 100%; }
Â  Â  Â  Â  .search-container { width: 100%; max-width: 1000px; margin-bottom: 20px; }
Â  Â  Â  Â  .search-input { width: 100%; padding: 16px; border-radius: 12px; border: 1px solid var(--glass-border); background: rgba(0,0,0,0.4); color: white; font-size: 16px; backdrop-filter: blur(5px); }
Â  Â  Â  Â  .search-input:focus { outline: none; border-color: var(--accent); box-shadow: 0 0 15px var(--accent-glow); }
Â  Â  Â  Â  .letter-header { font-size: 28px; font-weight: 800; color: var(--accent); border-bottom: 2px solid rgba(255,255,255,0.1); margin-top: 40px; margin-bottom: 20px; padding-bottom: 5px; scroll-margin-top: 110px; }
Â  Â  Â  Â  .letter-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 15px; }
Â  Â  Â  Â  .patho-card { background: rgba(255, 255, 255, 0.03); padding:24px; border-radius:16px; border:1px solid rgba(255,255,255,0.05); transition:all 0.3s; cursor:pointer; }
Â  Â  Â  Â  .patho-card:hover { transform:translateY(-5px); border-color:var(--accent); background: rgba(0, 210, 255, 0.05); box-shadow: 0 10px 30px rgba(0,0,0,0.5), 0 0 20px var(--accent-glow); }
Â  Â  Â  Â  .patho-name { font-size:18px; font-weight:700; color:var(--accent); margin-bottom:8px; }
Â  Â  Â  Â  .patho-desc { font-size:14px; color:rgba(255,255,255,0.7); line-height:1.5; }

Â  Â  Â  Â  /* ALERTS & STATS */
Â  Â  Â  Â  .alert { padding:14px; border-radius:10px; margin:12px 0; font-size:14px; width: 100%; text-align: center; font-weight: 500;}
Â  Â  Â  Â  .alert-success { background: rgba(0, 255, 157, 0.1); border:1px solid var(--success); color:var(--success); box-shadow: 0 0 15px rgba(0, 255, 157, 0.2); }
Â  Â  Â  Â  .alert-error { background: rgba(255, 77, 77, 0.1); border:1px solid var(--error); color:var(--error); box-shadow: 0 0 15px rgba(255, 77, 77, 0.2); }
Â  Â  Â  Â  .stat-box { background: rgba(0,0,0,0.3); padding:20px; border-radius:12px; margin:10px 0; border: 1px solid rgba(255,255,255,0.05); text-align:center; }
Â  Â  Â  Â  .stat-number { font-size:36px; font-weight:700; color:white; text-shadow: 0 0 10px rgba(255,255,255,0.3); }
Â  Â  Â  Â  .diagnostic-result { background: rgba(0, 210, 255, 0.1); padding:30px; border-radius:20px; margin:20px 0; border:2px solid var(--accent); text-align:center; box-shadow: 0 0 30px var(--accent-glow); }
Â  Â  Â  Â  .diagnostic-name { font-size:32px; font-weight:700; color:white; margin-bottom:12px; text-shadow: 0 0 10px var(--accent); }
Â  Â  Â  Â  .score-badge { display:inline-block; background: var(--accent); color: #000; font-weight: 700; padding:6px 14px; border-radius:20px; font-size:14px; margin-top:12px; }
Â  Â  Â  Â  .result-item { padding:12px 16px; border-radius:10px; margin-bottom:8px; background: rgba(0,0,0,0.3); display:flex; justify-content:space-between; align-items:center; border: 1px solid rgba(255,255,255,0.05); }
Â  Â  Â  Â  .result-correct { border-left:4px solid var(--success); }
Â  Â  Â  Â  .result-missing { border-left:4px solid #f59e0b; }
Â  Â  Â  Â  .result-error { border-left:4px solid var(--error); }
Â  Â  Â  Â  .result-neutral { border-left:4px solid var(--info); background: rgba(96, 165, 250, 0.1); }
Â  Â  Â  Â Â 
Â  Â  Â  Â  @keyframes spin { 100% { transform: rotate(360deg); } }
Â  Â  Â  Â  @keyframes fadeIn { from { opacity:0; transform:translateY(10px); } to { opacity:1; transform:translateY(0); } }

Â  Â  Â  Â  /* FOOTER & SOCIALS */
Â  Â  Â  Â  footer {Â 
Â  Â  Â  Â  Â  Â  text-align:center; padding:30px 20px;Â 
Â  Â  Â  Â  Â  Â  background: rgba(0,0,0,0.5); font-size:13px;Â 
Â  Â  Â  Â  Â  Â  border-top: 1px solid rgba(255,255,255,0.05);Â 
Â  Â  Â  Â  Â  Â  display: flex; flex-direction: column; align-items: center; gap: 15px;
Â  Â  Â  Â  }
Â  Â  Â  Â  .social-links { display: flex; gap: 20px; margin-bottom: 10px; }
Â  Â  Â  Â  .social-link {Â 
Â  Â  Â  Â  Â  Â  display: flex; align-items: center; justify-content: center;
Â  Â  Â  Â  Â  Â  width: 40px; height: 40px;
Â  Â  Â  Â  Â  Â  background: rgba(255,255,255,0.05);
Â  Â  Â  Â  Â  Â  border-radius: 50%;
Â  Â  Â  Â  Â  Â  transition: all 0.3s;
Â  Â  Â  Â  Â  Â  text-decoration: none;
Â  Â  Â  Â  }
Â  Â  Â  Â  .social-link:hover {Â 
Â  Â  Â  Â  Â  Â  background: rgba(0, 210, 255, 0.1);Â 
Â  Â  Â  Â  Â  Â  transform: scale(1.1);Â 
Â  Â  Â  Â  Â  Â  box-shadow: 0 0 15px var(--accent-glow);
Â  Â  Â  Â  }
Â  Â  Â  Â  .social-icon { width: 20px; height: 20px; fill: var(--text-muted); transition: fill 0.3s; }
Â  Â  Â  Â  .social-link:hover .social-icon { fill: var(--accent); }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .footer-nav { display: flex; gap: 20px; flex-wrap: wrap; justify-content: center;}
Â  Â  Â  Â  .footer-link { color: var(--text-muted); text-decoration: none; font-weight: 500; transition: color 0.2s; cursor: pointer;}
Â  Â  Â  Â  .footer-link:hover { color: var(--accent); text-decoration: underline; }

Â  Â  Â  Â  @media (max-width:600px){
Â  Â  Â  Â  Â  Â  .button-group{flex-direction:column;width:100%;}
Â  Â  Â  Â  Â  Â  .btn,.link{width:100%;}
Â  Â  Â  Â  Â  Â  .glossary-wrapper { flex-direction: column; }
Â  Â  Â  Â  Â  Â  .alphabet-sidebar { flex-direction: row; flex-wrap: wrap; width: 100%; position: static; justify-content: center; margin-bottom: 20px; max-height: none; }
Â  Â  Â  Â  Â  Â  .alpha-link { padding: 5px 10px; font-size: 14px; }
Â  Â  Â  Â  Â  Â  .reviews-container { grid-template-columns: 1fr; }
Â  Â  Â  Â  }
Â  Â  </style>
</head>
<body>

Â  Â  <header>
Â  Â  Â  Â  <div class="brand" id="brandLogo">
Â  Â  Â  Â  Â  Â  <img src="logo.png" alt="Medicome Logo" class="logo-img">
Â  Â  Â  Â  </div>
Â  Â  Â  Â Â 
Â  Â  Â  Â  <div class="top-right">
Â  Â  Â  Â  Â  Â  <button id="homeBtn" class="link" style="display:none;">Accueil</button>
Â  Â  Â  Â  Â  Â  <div id="pseudoBox" class="pseudo" style="display:none;">Utilisateur</div>
Â  Â  Â  Â  Â  Â  <button id="logoutBtn" class="link" style="display:none;">DÃ©connexion</button>
Â  Â  Â  Â  </div>
Â  Â  </header>

Â  Â  <main id="app">
Â  Â  Â  Â  <div class="center">
Â  Â  Â  Â  Â  Â  <div style="font-size: 40px; animation: spin 1s infinite linear; margin-bottom: 20px;">âš™ï¸</div>
Â  Â  Â  Â  Â  Â  <div class="small">Chargement du noyau mÃ©dical...</div>
Â  Â  Â  Â  </div>
Â  Â  </main>

Â  Â  <footer>
Â  Â  Â  Â  <div class="social-links">
Â  Â  Â  Â  Â  Â  <a href="https://instagram.com/medicome.fr" target="_blank" class="social-link" title="Instagram">
Â  Â  Â  Â  Â  Â  Â  Â  <svg class="social-icon" viewBox="0 0 24 24"><path d="M7.8,2H16.2C19.4,2 22,4.6 22,7.8V16.2A5.8,5.8 0 0,1 16.2,22H7.8C4.6,22 2,19.4 2,16.2V7.8A5.8,5.8 0 0,1 7.8,2M7.6,4A3.6,3.6 0 0,0 4,7.6V16.4C4,18.39 5.61,20 7.6,20H16.4A3.6,3.6 0 0,0 20,16.4V7.6C20,5.61 18.39,4 16.4,4H7.6M17.25,5.5A1.25,1.25 0 0,1 18.5,6.75A1.25,1.25 0 0,1 17.25,8A1.25,1.25 0 0,1 16,6.75A1.25,1.25 0 0,1 17.25,5.5M12,7A5,5 0 0,1 17,12A5,5 0 0,1 12,17A5,5 0 0,1 7,12A5,5 0 0,1 12,7M12,9A3,3 0 0,0 9,12A3,3 0 0,0 12,15A3,3 0 0,0 15,12A3,3 0 0,0 12,9Z" /></svg>
Â  Â  Â  Â  Â  Â  </a>
Â  Â  Â  Â  Â  Â  <a href="https://www.tiktok.com/@medicome.fr" target="_blank" class="social-link" title="TikTok">
Â  Â  Â  Â  Â  Â  Â  Â  <svg class="social-icon" viewBox="0 0 24 24"><path d="M12.5 3.5v10.55c0 1.9-1.55 3.45-3.45 3.45S5.6 15.95 5.6 14.05c0-1.9 1.55-3.45 3.45-3.45 0.3 0 0.6 0.05 0.85 0.15V7.4c-0.25-0.1-0.55-0.15-0.85-0.15-3.8 0-6.9 3.1-6.9 6.9s3.1 6.9 6.9 6.9c3.8 0 6.9-3.1 6.9-6.9V7.6c1.7 1.2 3.8 1.9 6.05 1.9v-3.75c-2.15 0-4.05-0.9-5.3-2.3H12.5z"/></svg>
Â  Â  Â  Â  Â  Â  </a>
Â  Â  Â  Â  Â  Â  <a href="https://x.com/medicome_fr" target="_blank" class="social-link" title="X (Twitter)">
Â  Â  Â  Â  Â  Â  Â  Â  <svg class="social-icon" viewBox="0 0 24 24"><path d="M22.46,6C21.69,6.35 20.86,6.58 20,6.69C20.88,6.16 21.56,5.32 21.88,4.31C21.05,4.81 20.13,5.16 19.16,5.36C18.37,4.5 17.26,4 16,4C13.65,4 11.73,5.92 11.73,8.29C11.73,8.63 11.77,8.96 11.84,9.27C8.28,9.09 5.11,7.38 3,4.79C2.63,5.42 2.42,6.16 2.42,6.94C2.42,8.43 3.17,9.75 4.33,10.5C3.62,10.5 2.96,10.3 2.38,10C2.38,10 2.38,10.03 2.38,10.05C2.38,12.11 3.86,13.85 5.82,14.24C5.46,14.34 5.08,14.39 4.69,14.39C4.42,14.39 4.15,14.36 3.89,14.31C4.43,16 6,17.26 7.89,17.29C6.43,18.45 4.58,19.13 2.56,19.13C2.22,19.13 1.88,19.11 1.54,19.07C3.44,20.29 5.7,21 8.12,21C16,21 20.33,14.46 20.33,8.79C20.33,8.6 20.33,8.42 20.32,8.23C21.16,7.63 21.88,6.87 22.46,6Z" /></svg>
Â  Â  Â  Â  Â  Â  </a>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <div class="footer-nav">
Â  Â  Â  Â  Â  Â  <span class="footer-link" onclick="window.scrollTo(0,0)">Haut de page</span>
Â  Â  Â  Â  Â  Â  <span class="footer-link" id="reviewsLink">Avis Utilisateurs</span>
Â  Â  Â  Â  Â  Â  <span class="footer-link" id="contactLink">Nous Contacter</span>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <div style="margin-top:10px; opacity:0.6;">Medicome Â© 2025 - Outil pÃ©dagogique</div>
Â  Â  </footer>

Â  Â  <script type="module">
Â  Â  Â  Â  if (window.location.hostname.includes("github.io")) {
Â  Â  Â  Â  Â  Â  window.location.href = "https://medicome.fr";
Â  Â  Â  Â  }

Â  Â  Â  Â  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
Â  Â  Â  Â  import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, signOut, onAuthStateChanged, updateProfile, sendPasswordResetEmail } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
Â  Â  Â  Â  import { getFirestore, doc, getDoc, setDoc, addDoc, collection } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

Â  Â  Â  Â  const firebaseConfig = {
Â  Â  Â  Â  Â  Â  apiKey: "AIzaSyCig9G4gYHU5h642YV1IZxthYm_IXp6vZU",
Â  Â  Â  Â  Â  Â  authDomain: "medicome-paco.firebaseapp.com",
Â  Â  Â  Â  Â  Â  projectId: "medicome-paco",
Â  Â  Â  Â  Â  Â  storageBucket: "medicome-paco.firebasestorage.app",
Â  Â  Â  Â  Â  Â  messagingSenderId: "332171806096",
Â  Â  Â  Â  Â  Â  appId: "1:332171806096:web:36889325196a7a718b5f15",
Â  Â  Â  Â  Â  Â  measurementId: "G-81HJ9DWBMX"
Â  Â  Â  Â  };

Â  Â  Â  Â  let app, auth, db;
Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  Â  app = initializeApp(firebaseConfig);
Â  Â  Â  Â  Â  Â  auth = getAuth(app);
Â  Â  Â  Â  Â  Â  db = getFirestore(app);
Â  Â  Â  Â  } catch (error) {
Â  Â  Â  Â  Â  Â  console.error("Erreur Firebase:", error);
Â  Â  Â  Â  Â  Â  document.querySelector('#app').innerHTML = `<div class="alert alert-error">Erreur de configuration : ${error.message}</div>`;
Â  Â  Â  Â  }

Â  Â  Â  Â  let PATHOLOGIES = [];
Â  Â  Â  Â  const ACCESS_CODES = [ { code: "SuperCode1", pseudo:"Admin" } ];

Â  Â  Â  Â  // STATE (With History)
Â  Â  Â  Â  let state = {
Â  Â  Â  Â  Â  Â  currentUser: null, pseudo: null, progression: { correct: 0, incorrect: 0 },
Â  Â  Â  Â  Â  Â  isGuest: false, demo:{}, currentSign:null, answers:{}, asked:[], allSigns:[], ranked: [], diagnosticShown:false, previousDiagnostics:[],
Â  Â  Â  Â  Â  Â  history: [] // For going back
Â  Â  Â  Â  };

Â  Â  Â  Â  async function initApp() {
Â  Â  Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  Â  Â  Â  const response = await fetch('./pathologies.json');
Â  Â  Â  Â  Â  Â  Â  Â  if (!response.ok) throw new Error("Impossible de lire le fichier de donnÃ©es");
Â  Â  Â  Â  Â  Â  Â  Â  PATHOLOGIES = await response.json();
Â  Â  Â  Â  Â  Â  Â  Â  startAuthListener();
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  // Bind links
Â  Â  Â  Â  Â  Â  Â  Â  const cLink = document.getElementById('contactLink');
Â  Â  Â  Â  Â  Â  Â  Â  if(cLink) cLink.onclick = renderContact;
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  const rLink = document.getElementById('reviewsLink');
Â  Â  Â  Â  Â  Â  Â  Â  if(rLink) rLink.onclick = renderReviews;

Â  Â  Â  Â  Â  Â  Â  Â  // LOGO LOGIC (Only click if logged in)
Â  Â  Â  Â  Â  Â  Â  Â  const brandLogo = document.getElementById('brandLogo');
Â  Â  Â  Â  Â  Â  Â  Â  if(brandLogo) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  brandLogo.onclick = () => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (state.currentUser || state.isGuest) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  renderHome();
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // Do nothing or renderLogin() if not already there
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  console.log("Not logged in, logo inactive");
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  };
Â  Â  Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  } catch (err) {
Â  Â  Â  Â  Â  Â  Â  Â  console.error(err);
Â  Â  Â  Â  Â  Â  Â  Â  document.querySelector('#app').innerHTML = `
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="card center">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <h2 style="color:var(--error)">Erreur de chargement</h2>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <p>Impossible de charger 'pathologies.json'.</p>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="small" style="color:orange">${err.message}</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  `;
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }
Â  Â  Â  Â  initApp();

Â  Â  Â  Â  function startAuthListener() {
Â  Â  Â  Â  Â  Â  onAuthStateChanged(auth, async (user) => {
Â  Â  Â  Â  Â  Â  Â  Â  if (user) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  state.currentUser = user; state.isGuest = false;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  let displayPseudo = user.displayName;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (!displayPseudo && user.email) displayPseudo = user.email.split('@')[0];
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  state.pseudo = displayPseudo; updateHeader();Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const docRef = doc(db, "users", user.uid);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const docSnap = await getDoc(docRef);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (docSnap.exists()) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const data = docSnap.data();
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (data.pseudo) state.pseudo = data.pseudo;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  state.progression = data.progression || { correct: 0, incorrect: 0 };
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  } else { saveProgression(); }
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  updateHeader(); renderHome();
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  } catch(e) { renderHome(); }
Â  Â  Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const savedGuest = localStorage.getItem('medicome_guest_progression');
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const savedPseudo = localStorage.getItem('medicome_guest_pseudo');
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if(!state.isGuest && savedGuest && savedPseudo) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  state.isGuest = true; state.pseudo = savedPseudo;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  state.progression = JSON.parse(savedGuest);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  updateHeader(); renderHome();
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  setTimeout(() => showAlert(`Bon retour, ${state.pseudo} !`, 'success'), 500);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  state.currentUser = null; state.pseudo = null; state.progression = { correct: 0, incorrect: 0 };
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  renderLogin(); updateHeader();
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  }

Â  Â  Â  Â  function q(sel){ return document.querySelector(sel); }
Â  Â  Â  Â  function formatSigneName(sign){ return sign.replace(/_/g,' ').replace(/\b\w/g,c=>c.toUpperCase()); }
Â  Â  Â  Â  function showAlert(message,type){
Â  Â  Â  Â  Â  Â  const alertDiv = document.createElement('div');
Â  Â  Â  Â  Â  Â  alertDiv.className = 'alert alert-' + type;
Â  Â  Â  Â  Â  Â  alertDiv.textContent = message;
Â  Â  Â  Â  Â  Â  const app = q('#app');
Â  Â  Â  Â  Â  Â  if(app){ app.insertBefore(alertDiv,app.firstChild); setTimeout(()=>{ if(alertDiv.parentNode) alertDiv.parentNode.removeChild(alertDiv); },3000); }
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  function triggerConfetti() {
Â  Â  Â  Â  Â  Â  if(window.confetti) {
Â  Â  Â  Â  Â  Â  Â  Â  window.confetti({ particleCount: 100, spread: 70, origin: { y: 0.6 } });
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }

Â  Â  Â  Â  async function saveProgression() {
Â  Â  Â  Â  Â  Â  if (!state.isGuest && state.currentUser) {
Â  Â  Â  Â  Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const userRef = doc(db, "users", state.currentUser.uid);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  await setDoc(userRef, { progression: state.progression, pseudo: state.pseudo, lastUpdate: new Date() }, { merge: true });
Â  Â  Â  Â  Â  Â  Â  Â  } catch (e) { console.error("Erreur sauvegarde Cloud", e); }
Â  Â  Â  Â  Â  Â  } else if (state.isGuest) {
Â  Â  Â  Â  Â  Â  Â  Â  localStorage.setItem('medicome_guest_progression', JSON.stringify(state.progression));
Â  Â  Â  Â  Â  Â  Â  Â  localStorage.setItem('medicome_guest_pseudo', state.pseudo);
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }

Â  Â  Â  Â  function updateHeader(){
Â  Â  Â  Â  Â  Â  const pseudoBox = q("#pseudoBox"); const homeBtn = q("#homeBtn"); const logoutBtn = q("#logoutBtn");
Â  Â  Â  Â  Â  Â  if(state.pseudo){Â 
Â  Â  Â  Â  Â  Â  Â  Â  pseudoBox.textContent = state.pseudo + (state.isGuest ? " (Local)" : "");Â 
Â  Â  Â  Â  Â  Â  Â  Â  pseudoBox.style.display='inline-block'; pseudoBox.onclick=renderProfile;
Â  Â  Â  Â  Â  Â  Â  Â  homeBtn.style.display='inline-block'; logoutBtn.style.display='inline-block';
Â  Â  Â  Â  Â  Â  } else {Â 
Â  Â  Â  Â  Â  Â  Â  Â  pseudoBox.style.display='none'; homeBtn.style.display='none'; logoutBtn.style.display='none';
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  homeBtn.onclick=renderHome;
Â  Â  Â  Â  Â  Â  logoutBtn.onclick = () => {
Â  Â  Â  Â  Â  Â  Â  Â  localStorage.removeItem('medicome_guest_progression'); localStorage.removeItem('medicome_guest_pseudo');
Â  Â  Â  Â  Â  Â  Â  Â  state.isGuest = false; state.pseudo = null; state.currentUser = null; state.progression = { correct: 0, incorrect: 0 };Â 
Â  Â  Â  Â  Â  Â  Â  Â  signOut(auth).then(() => { renderLogin(); updateHeader(); showAlert("DÃ©connectÃ©", "success"); }).catch(() => { renderLogin(); updateHeader(); });
Â  Â  Â  Â  Â  Â  };
Â  Â  Â  Â  }

Â  Â  Â  Â  // =================== REVIEWS PAGE ===================
Â  Â  Â  Â  function renderReviews() {
Â  Â  Â  Â  Â  Â  const app = q('#app'); app.innerHTML='';
Â  Â  Â  Â  Â  Â  const card = document.createElement('div'); card.className='card center';
Â  Â  Â  Â  Â  Â  card.innerHTML = `<h2>â­ Avis Utilisateurs</h2><p class="small" style="margin-bottom:20px">Ce qu'ils pensent de Medicome.</p>`;

Â  Â  Â  Â  Â  Â  const reviewsContainer = document.createElement('div');
Â  Â  Â  Â  Â  Â  reviewsContainer.className = 'reviews-container';
Â  Â  Â  Â  Â  Â  reviewsContainer.innerHTML = `
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="review-card">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="review-header">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="review-avatar">A</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="review-name">Antoine D.</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="review-stars">â˜…â˜…â˜…â˜…â˜…</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="review-text">"Super outil pour rÃ©viser mes cas cliniques avant les partiels. Simple et efficace."</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="review-card">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="review-header">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="review-avatar">S</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="review-name">Sarah L.</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="review-stars">â˜…â˜…â˜…â˜…â˜†</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="review-text">"L'interface est top. J'aimerais juste encore plus de pathologies !"</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="review-card">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="review-header">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="review-avatar">M</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="review-name">Maxime P.</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="review-stars">â˜…â˜…â˜…â˜…â˜…</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="review-text">"Indispensable pour l'externat. Le mode invitÃ© est super pratique."</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="review-card">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="review-header">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="review-avatar">L</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="review-name">LÃ©a B.</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="review-stars">â˜…â˜…â˜…â˜…â˜…</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="review-text">"Merci pour cet outil gratuit. Ã‡a m'a sauvÃ© sur la sÃ©mio cardio !"</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  `;
Â  Â  Â  Â  Â  Â  card.appendChild(reviewsContainer);
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  const btnBack = document.createElement('button'); btnBack.className='btn'; btnBack.textContent='Retour';
Â  Â  Â  Â  Â  Â  btnBack.style.marginTop = '20px';
Â  Â  Â  Â  Â  Â  btnBack.onclick = () => { if(state.pseudo) renderHome(); else renderLogin(); };
Â  Â  Â  Â  Â  Â  card.appendChild(btnBack);

Â  Â  Â  Â  Â  Â  app.appendChild(card);
Â  Â  Â  Â  }

Â  Â  Â  Â  // =================== CONTACT FORM ===================
Â  Â  Â  Â  function renderContact() {
Â  Â  Â  Â  Â  Â  const app = q('#app'); app.innerHTML='';
Â  Â  Â  Â  Â  Â  const card = document.createElement('div'); card.className='card center';
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  card.innerHTML = `<h2>âœ‰ï¸ Nous Contacter</h2><p class="small" style="margin-bottom:20px">Une suggestion ? Un bug ? Ã‰crivez-nous.</p>`;
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  const inputName = document.createElement('input'); inputName.className='input'; inputName.placeholder='Votre Nom';
Â  Â  Â  Â  Â  Â  if(state.pseudo) inputName.value = state.pseudo;
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  const inputEmail = document.createElement('input'); inputEmail.className='input'; inputEmail.placeholder='Votre Email';
Â  Â  Â  Â  Â  Â  if(state.currentUser && state.currentUser.email) inputEmail.value = state.currentUser.email;

Â  Â  Â  Â  Â  Â  const inputText = document.createElement('textarea'); inputText.className='input'; inputText.placeholder='Votre message...';
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  const btnSend = document.createElement('button'); btnSend.className='btn'; btnSend.textContent='Envoyer le message';
Â  Â  Â  Â  Â  Â  btnSend.onclick = async () => {
Â  Â  Â  Â  Â  Â  Â  Â  if(!inputText.value || !inputEmail.value) { showAlert("Merci de remplir les champs", "error"); return; }
Â  Â  Â  Â  Â  Â  Â  Â  btnSend.textContent = 'Envoi...';
Â  Â  Â  Â  Â  Â  Â  Â  btnSend.disabled = true;

Â  Â  Â  Â  Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // SAVE TO FIREBASE
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  await addDoc(collection(db, "messages"), {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  name: inputName.value,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  email: inputEmail.value,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  message: inputText.value,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  date: new Date(),
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  uid: state.currentUser ? state.currentUser.uid : 'guest'
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  showAlert("Message envoyÃ© avec succÃ¨s !", "success");
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  setTimeout(() => { if(state.pseudo) renderHome(); else renderLogin(); }, 1500);
Â  Â  Â  Â  Â  Â  Â  Â  } catch(e) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  console.error(e);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  showAlert("Erreur lors de l'envoi", "error");
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  btnSend.textContent = 'Envoyer le message';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  btnSend.disabled = false;
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  };

Â  Â  Â  Â  Â  Â  const btnCancel = document.createElement('button'); btnCancel.className='link'; btnCancel.textContent='Annuler';
Â  Â  Â  Â  Â  Â  btnCancel.onclick = () => { if(state.pseudo) renderHome(); else renderLogin(); };

Â  Â  Â  Â  Â  Â  card.appendChild(inputName);
Â  Â  Â  Â  Â  Â  card.appendChild(inputEmail);
Â  Â  Â  Â  Â  Â  card.appendChild(inputText);
Â  Â  Â  Â  Â  Â  card.appendChild(btnSend);
Â  Â  Â  Â  Â  Â  card.appendChild(btnCancel);
Â  Â  Â  Â  Â  Â  app.appendChild(card);
Â  Â  Â  Â  }

Â  Â  Â  Â  function renderLogin() {
Â  Â  Â  Â  Â  Â  const app = q('#app'); app.innerHTML='';
Â  Â  Â  Â  Â  Â  const card = document.createElement('div'); card.className='card center'; card.innerHTML='<h2>â˜ï¸ Connexion Cloud</h2>';
Â  Â  Â  Â  Â  Â  const inputUser = document.createElement('input'); inputUser.placeholder='Email'; inputUser.className='input';
Â  Â  Â  Â  Â  Â  const inputPass = document.createElement('input'); inputPass.placeholder='Mot de passe'; inputPass.className='input'; inputPass.type='password';
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  const btnLogin = document.createElement('button'); btnLogin.className='btn'; btnLogin.textContent='Se connecter';
Â  Â  Â  Â  Â  Â  btnLogin.onclick = async () => {
Â  Â  Â  Â  Â  Â  Â  Â  try { await signInWithEmailAndPassword(auth, inputUser.value, inputPass.value); showAlert("Connexion rÃ©ussie !", "success"); } catch (error) { showAlert("Erreur: " + error.message, "error"); }
Â  Â  Â  Â  Â  Â  };
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  const btnForgot = document.createElement('div');Â 
Â  Â  Â  Â  Â  Â  btnForgot.className='small link'; btnForgot.style.border='none'; btnForgot.textContent='Mot de passe oubliÃ© ?';
Â  Â  Â  Â  Â  Â  btnForgot.onclick = async () => {
Â  Â  Â  Â  Â  Â  Â  Â  if(!inputUser.value) return showAlert("Veuillez entrer votre email d'abord", "error");
Â  Â  Â  Â  Â  Â  Â  Â  try { await sendPasswordResetEmail(auth, inputUser.value); showAlert("Email de rÃ©initialisation envoyÃ© !", "success"); } catch(e) { showAlert("Erreur: " + e.message, "error"); }
Â  Â  Â  Â  Â  Â  };

Â  Â  Â  Â  Â  Â  card.appendChild(inputUser); card.appendChild(inputPass); card.appendChild(btnLogin); card.appendChild(btnForgot);
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  const sep = document.createElement('div'); sep.textContent='â€” Pas encore de compte ? â€”'; sep.className='small'; sep.style.margin='16px 0'; card.appendChild(sep);
Â  Â  Â  Â  Â  Â  const inRegEmail = document.createElement('input'); inRegEmail.placeholder='Nouvel Email'; inRegEmail.className='input';
Â  Â  Â  Â  Â  Â  const inRegPass = document.createElement('input'); inRegPass.placeholder='Nouveau Mot de passe'; inRegPass.className='input'; inRegPass.type='password';
Â  Â  Â  Â  Â  Â  const inPseudo = document.createElement('input'); inPseudo.placeholder='Votre Pseudo'; inPseudo.className='input';
Â  Â  Â  Â  Â  Â  const btnReg = document.createElement('button'); btnReg.className='link'; btnReg.textContent='CrÃ©er un compte Cloud';
Â  Â  Â  Â  Â  Â  btnReg.onclick = async () => {
Â  Â  Â  Â  Â  Â  Â  Â  if(!inRegEmail.value || !inRegPass.value || !inPseudo.value) return showAlert('Remplissez tout','error');
Â  Â  Â  Â  Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const userCredential = await createUserWithEmailAndPassword(auth, inRegEmail.value, inRegPass.value);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const user = userCredential.user; await updateProfile(user, { displayName: inPseudo.value });
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  await setDoc(doc(db, "users", user.uid), { pseudo: inPseudo.value, email: inRegEmail.value, progression: { correct: 0, incorrect: 0 }, createdAt: new Date() }, { merge: true });
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  state.pseudo = inPseudo.value; showAlert("Compte crÃ©Ã© !", "success"); updateHeader(); renderHome();
Â  Â  Â  Â  Â  Â  Â  Â  } catch (error) { showAlert("Erreur crÃ©ation: " + error.message, "error"); }
Â  Â  Â  Â  Â  Â  };
Â  Â  Â  Â  Â  Â  card.appendChild(inRegEmail); card.appendChild(inRegPass); card.appendChild(inPseudo); card.appendChild(btnReg);
Â  Â  Â  Â  Â  Â  const sepCode = document.createElement('div'); sepCode.textContent='â€” ou AccÃ¨s Rapide (Local) â€”'; sepCode.className='small'; sepCode.style.margin='16px 0'; card.appendChild(sepCode);
Â  Â  Â  Â  Â  Â  const inputCode = document.createElement('input'); inputCode.placeholder='ClÃ© d\'accÃ¨s'; inputCode.className='input';
Â  Â  Â  Â  Â  Â  const btnCode = document.createElement('button'); btnCode.className='btn btn-code'; btnCode.textContent='Utiliser une clÃ©';
Â  Â  Â  Â  Â  Â  btnCode.onclick = () => {
Â  Â  Â  Â  Â  Â  Â  Â  const codeFound = ACCESS_CODES.find(ac => ac.code === inputCode.value);
Â  Â  Â  Â  Â  Â  Â  Â  if(codeFound) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  state.isGuest = true; state.pseudo = codeFound.pseudo; state.progression = {correct:0, incorrect:0};
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  saveProgression(); updateHeader(); renderHome(); showAlert(`Mode InvitÃ©: ${codeFound.pseudo}`, 'success');
Â  Â  Â  Â  Â  Â  Â  Â  } else { showAlert('ClÃ© invalide', 'error'); }
Â  Â  Â  Â  Â  Â  };
Â  Â  Â  Â  Â  Â  card.appendChild(inputCode); card.appendChild(btnCode); app.appendChild(card);
Â  Â  Â  Â  }

Â  Â  Â  Â  function renderHome() {
Â  Â  Â  Â  Â  Â  const app = q('#app'); app.innerHTML='';
Â  Â  Â  Â  Â  Â  const prog = state.progression;
Â  Â  Â  Â  Â  Â  const card = document.createElement('div'); card.className='card center';
Â  Â  Â  Â  Â  Â  let cloudBadge = state.isGuest ? '<span style="color:orange; font-size:0.8em; margin-bottom:10px">ğŸ’¾ Mode Local (Navigateur)</span>' : '<span style="color:var(--success); font-size:0.8em; margin-bottom:10px">â˜ï¸ Sauvegarde Cloud Active</span>';
Â  Â  Â  Â  Â  Â  const displayName = state.pseudo || '...';
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  // --- NOUVEAU TUTORIEL PÃ‰DAGOGIE INVERSÃ‰E ---
Â  Â  Â  Â  Â  Â  const tutorialHTML = `
Â  Â  Â  Â  Â  Â  Â  Â  <div style="background: rgba(0, 210, 255, 0.05); border: 1px solid var(--accent); border-radius: 12px; padding: 20px; margin: 20px 0; text-align: left; width: 100%;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <h3 style="color:var(--accent); font-size: 1.1em; margin-bottom: 10px;">ğŸ“ Mode d'emploi : DÃ©fie l'Algorithme</h3>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <p style="font-size: 0.95em; line-height: 1.5; color: #e0e7ff;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Ici, c'est le monde Ã  l'envers : <strong>C'est toi qui connais le diagnostic, et l'IA qui doit le deviner.</strong>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </p>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <ul style="margin-top: 10px; margin-left: 20px; font-size: 0.9em; color: var(--text-muted);">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <li style="margin-bottom:5px;">ğŸ§  <strong>Ã‰tape 1 :</strong> Choisis une pathologie dans ta tÃªte (ex: Appendicite).</li>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <li style="margin-bottom:5px;">ğŸ©º <strong>Ã‰tape 2 :</strong> L'IA va te poser des questions sur les signes cliniques.</li>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <li>âœ… <strong>Ã‰tape 3 :</strong> RÃ©ponds correctement (OUI/NON) pour guider l'IA vers ta pathologie.</li>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </ul>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <p style="margin-top: 10px; font-size: 0.85em; font-style: italic; color: var(--accent);">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Si l'IA se trompe, c'est peut-Ãªtre que tu as oubliÃ© un signe clinique important !
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </p>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  `;

Â  Â  Â  Â  Â  Â  // DASHBOARD CONTENU
Â  Â  Â  Â  Â  Â  card.innerHTML = `<h2>ğŸ‘‹ Bonjour ${displayName}</h2>${cloudBadge}
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ${tutorialHTML}

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="stat-box" style="width:100%"><div class="stat-number">${prog.correct + prog.incorrect}</div><div class="stat-label">Cas jouÃ©s</div></div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px;width:100%;margin-top:12px;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="stat-box" style="text-align:center; background:rgba(0, 255, 157, 0.1); border-color:var(--success)"><div class="stat-number" style="color:var(--success);">${prog.correct}</div><div class="stat-label">IA a trouvÃ©</div></div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="stat-box" style="text-align:center; background:rgba(255, 77, 77, 0.1); border-color:var(--error)"><div class="stat-number" style="color:var(--error);">${prog.incorrect}</div><div class="stat-label">Ã‰checs</div></div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>`;
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  const btnDiag = document.createElement('button'); btnDiag.className='btn'; btnDiag.textContent='ğŸ©º Lancer le dÃ©fi'; btnDiag.style.marginTop='24px'; btnDiag.style.width='100%'; btnDiag.onclick=renderDemographics;
Â  Â  Â  Â  Â  Â  const btnGloss = document.createElement('button'); btnGloss.className='link'; btnGloss.textContent='ğŸ“š Glossaire des pathologies'; btnGloss.style.marginTop='12px'; btnGloss.onclick=renderGlossary;
Â  Â  Â  Â  Â  Â  const btnProf = document.createElement('button'); btnProf.className='link'; btnProf.textContent='ğŸ‘¤ Mon Profil'; btnProf.style.marginTop='6px'; btnProf.onclick=renderProfile;
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  card.appendChild(btnDiag); card.appendChild(btnGloss); card.appendChild(btnProf);Â 
Â  Â  Â  Â  Â  Â  app.appendChild(card);
Â  Â  Â  Â  }

Â  Â  Â  Â  function renderProfile() {
Â  Â  Â  Â  Â  Â  const app = q('#app'); app.innerHTML='';
Â  Â  Â  Â  Â  Â  const prog = state.progression;
Â  Â  Â  Â  Â  Â  const total = prog.correct + prog.incorrect;
Â  Â  Â  Â  Â  Â  const successRate = total > 0 ? Math.round((prog.correct / total) * 100) : 0;
Â  Â  Â  Â  Â  Â  const card = document.createElement('div'); card.className='card center';
Â  Â  Â  Â  Â  Â  const title = document.createElement('h2'); title.textContent=`ğŸ‘¤ Profil de ${state.pseudo || 'Utilisateur'}`; card.appendChild(title);
Â  Â  Â  Â  Â  Â  const gridDiv = document.createElement('div');
Â  Â  Â  Â  Â  Â  gridDiv.style.cssText='display:grid;grid-template-columns:1fr 1fr;gap:12px;width:100%;margin-top:12px;';
Â  Â  Â  Â  Â  Â  gridDiv.innerHTML=`<div class="stat-box"><div class="stat-number" style="color:var(--success);">${prog.correct}</div><div class="stat-label">âœ“ Corrects</div></div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <div class="stat-box"><div class="stat-number" style="color:var(--error);">${prog.incorrect}</div><div class="stat-label">âœ— Incorrects</div></div>`;
Â  Â  Â  Â  Â  Â  card.appendChild(gridDiv);
Â  Â  Â  Â  Â  Â  const statRate = document.createElement('div');
Â  Â  Â  Â  Â  Â  statRate.className='stat-box'; statRate.style.width='100%';
Â  Â  Â  Â  Â  Â  statRate.style.cssText='margin-top:12px;background:rgba(0, 255, 157, 0.1);border-color:var(--success);';
Â  Â  Â  Â  Â  Â  statRate.innerHTML=`<div class="stat-number" style="color:var(--success);">${successRate}%</div><div class="stat-label">Taux de rÃ©ussite</div>`;
Â  Â  Â  Â  Â  Â  card.appendChild(statRate);
Â  Â  Â  Â  Â  Â  const btnReset = document.createElement('button');
Â  Â  Â  Â  Â  Â  btnReset.className = 'link'; btnReset.style.color = 'var(--error)'; btnReset.style.marginTop = '20px'; btnReset.style.borderColor = 'rgba(239, 68, 68, 0.3)';
Â  Â  Â  Â  Â  Â  btnReset.textContent = 'ğŸ—‘ï¸ RÃ©initialiser Stats';
Â  Â  Â  Â  Â  Â  btnReset.onclick = async () => {
Â  Â  Â  Â  Â  Â  Â  Â  if(confirm("Voulez-vous vraiment effacer toutes vos statistiques ?")) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  state.progression = { correct: 0, incorrect: 0 }; await saveProgression(); renderProfile(); showAlert("Statistiques remises Ã  zÃ©ro", "success");
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  };
Â  Â  Â  Â  Â  Â  card.appendChild(btnReset);
Â  Â  Â  Â  Â  Â  const btnBack = document.createElement('button'); btnBack.className='btn'; btnBack.textContent='ğŸ  Retour';
Â  Â  Â  Â  Â  Â  btnBack.style.marginTop='20px'; btnBack.onclick=renderHome;
Â  Â  Â  Â  Â  Â  card.appendChild(btnBack); app.appendChild(card);
Â  Â  Â  Â  }

Â  Â  Â  Â  // =================== GAME (DIAGNOSTIC) ===================

Â  Â  Â  Â  function renderDemographics() {
Â  Â  Â  Â  Â  Â  const app = q('#app'); app.innerHTML='';
Â  Â  Â  Â  Â  Â  const card = document.createElement('div'); card.className='card';
Â  Â  Â  Â  Â  Â  card.innerHTML=`<h3>ğŸ“‹ DonnÃ©es dÃ©mographiques</h3><p class="small" style="margin-bottom:20px">ParamÃ©trez le patient virtuel.</p>`;
Â  Â  Â  Â  Â  Â  const createSel = (lbl, id, opts) => {
Â  Â  Â  Â  Â  Â  Â  Â  const l = document.createElement('label'); l.textContent=lbl; l.style.color='var(--accent)';
Â  Â  Â  Â  Â  Â  Â  Â  const s = document.createElement('select'); s.id=id; s.className='input';
Â  Â  Â  Â  Â  Â  Â  Â  opts.forEach(o=> { const op=document.createElement('option'); op.value=o[0]; op.textContent=o[1]; s.appendChild(op); });
Â  Â  Â  Â  Â  Â  Â  Â  card.appendChild(l); card.appendChild(s);
Â  Â  Â  Â  Â  Â  };
Â  Â  Â  Â  Â  Â  createSel("Sexe", "demo-sexe", [["rien","AlÃ©atoire / Inconnu"],["femme","Femme"],["homme","Homme"]]);
Â  Â  Â  Â  Â  Â  createSel("Plus de 30 ans ?", "demo-30", [["rien","Je ne sais pas"],["oui","Oui"],["non","Non"]]);
Â  Â  Â  Â  Â  Â  createSel("Plus de 65 ans ?", "demo-65", [["rien","Je ne sais pas"],["oui","Oui"],["non","Non"]]);
Â  Â  Â  Â  Â  Â  createSel("AntÃ©cÃ©dents familiaux ?", "demo-atcd", [["rien","Je ne sais pas"],["oui","Oui"],["non","Non"]]);
Â  Â  Â  Â  Â  Â  createSel("Fumeur ?", "demo-tabac", [["rien","Je ne sais pas"],["oui","Oui"],["non","Non"]]);
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  const btnGroup = document.createElement('div'); btnGroup.className='button-group';
Â  Â  Â  Â  Â  Â  const btnStart = document.createElement('button'); btnStart.className='btn'; btnStart.textContent='â–¶ï¸ DÃ©marrer';
Â  Â  Â  Â  Â  Â  btnStart.onclick=()=>{Â 
Â  Â  Â  Â  Â  Â  state.demo = {
Â  Â  Â  Â  Â  Â  Â  Â  femme: q('#demo-sexe').value === 'femme', homme: q('#demo-sexe').value === 'homme',
Â  Â  Â  Â  Â  Â  Â  Â  plus_de_30ans: q('#demo-30').value === 'oui', plus_de_65ans: q('#demo-65').value === 'oui',
Â  Â  Â  Â  Â  Â  Â  Â  atcd_famille: q('#demo-atcd').value === 'oui', tabac: q('#demo-tabac').value === 'oui'
Â  Â  Â  Â  Â  Â  };
Â  Â  Â  Â  Â  Â  state.answers={}; state.asked=[]; state.diagnosticShown=false; state.previousDiagnostics=[]; state.history=[];
Â  Â  Â  Â  Â  Â  askNextQuestion();
Â  Â  Â  Â  Â  Â  };
Â  Â  Â  Â  Â  Â  const btnCancel = document.createElement('button'); btnCancel.className='link'; btnCancel.textContent='Annuler'; btnCancel.onclick=renderHome;
Â  Â  Â  Â  Â  Â  btnGroup.appendChild(btnStart); btnGroup.appendChild(btnCancel); card.appendChild(btnGroup); app.appendChild(card);
Â  Â  Â  Â  }

Â  Â  Â  Â  function prepareSigns() {
Â  Â  Â  Â  Â  Â  let allSignsSet = new Set();
Â  Â  Â  Â  Â  Â  PATHOLOGIES.forEach(p => { Object.keys(p.signes).forEach(s => allSignsSet.add(s)); });
Â  Â  Â  Â  Â  Â  state.allSigns = Array.from(allSignsSet);
Â  Â  Â  Â  }

Â  Â  Â  Â  function rankPathologies() {
Â  Â  Â  Â  Â  Â  const scores = PATHOLOGIES.map(p => {
Â  Â  Â  Â  Â  Â  Â  Â  let score = 0;
Â  Â  Â  Â  Â  Â  Â  Â  for(const facteur in p.facteurs){ if(state.demo[facteur] === true) score += p.facteurs[facteur]; }
Â  Â  Â  Â  Â  Â  Â  Â  for(const signe in p.signes){
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const ans = state.answers[signe];
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if(ans === true) score += p.signes[signe];
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  else if(ans === false) score -= (p.signes[signe] * 0.5);
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  return {patho:p, score: Math.max(0, score)};
Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  const totalScore = scores.reduce((sum, s) => sum + s.score, 0);
Â  Â  Â  Â  Â  Â  state.ranked = scores.map(s => ({
Â  Â  Â  Â  Â  Â  Â  Â  ...s, prob: totalScore > 0 ? ((s.score / totalScore) * 100).toFixed(1) : 0
Â  Â  Â  Â  Â  Â  })).sort((a,b)=>b.prob - a.prob);
Â  Â  Â  Â  }

Â  Â  Â  Â  function getNextSmartSign(rankedPathos, remainingSigns) {
Â  Â  Â  Â  Â  Â  if (rankedPathos.length < 2) return remainingSigns[Math.floor(Math.random() * remainingSigns.length)];
Â  Â  Â  Â  Â  Â  const top1 = rankedPathos[0].patho, top2 = rankedPathos[1].patho;
Â  Â  Â  Â  Â  Â  let best=null, maxD=-1;
Â  Â  Â  Â  Â  Â  remainingSigns.forEach(s => {
Â  Â  Â  Â  Â  Â  Â  Â  const w1 = top1.signes[s] || 0, w2 = top2.signes[s] || 0;
Â  Â  Â  Â  Â  Â  Â  Â  const d = Math.abs(w1 - w2);
Â  Â  Â  Â  Â  Â  Â  Â  if (d > maxD) { maxD = d; best = s; }
Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  return (best && maxD > 0) ? best : remainingSigns[Math.floor(Math.random() * remainingSigns.length)];
Â  Â  Â  Â  }

Â  Â  Â  Â  function canShowDiagnostic() {
Â  Â  Â  Â  Â  Â  const qNum = state.asked.length;
Â  Â  Â  Â  Â  Â  if(state.ranked.length===0) return false;
Â  Â  Â  Â  Â  Â  const topProb = parseFloat(state.ranked[0].prob);
Â  Â  Â  Â  Â  Â  const topName = state.ranked[0].patho.name;
Â  Â  Â  Â  Â  Â  if(state.previousDiagnostics.includes(topName)) return false;
Â  Â  Â  Â  Â  Â  if(qNum >= 8 && topProb >= 90) return true;
Â  Â  Â  Â  Â  Â  if(qNum >= 14 && topProb >= 85) return true;
Â  Â  Â  Â  Â  Â  if(qNum >= 17 && topProb >= 75) return true;
Â  Â  Â  Â  Â  Â  return false;
Â  Â  Â  Â  }

Â  Â  Â  Â  function renderCurrentQuestion() {
Â  Â  Â  Â  Â  Â  const app = q('#app'); app.innerHTML='';
Â  Â  Â  Â  Â  Â  const card = document.createElement('div'); card.className='card center';
Â  Â  Â  Â  Â  Â  const signe = state.currentSign;
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  card.innerHTML=`<div class="small" style="margin-bottom:12px; color:var(--accent)">QUESTION ${state.asked.length}</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="question-text">Le patient prÃ©sente-t-il :<br><strong style="font-size:1.2em; color:white;">${formatSigneName(signe)}</strong> ?</div>`;
Â  Â  Â  Â  Â  Â  const btnGroup = document.createElement('div'); btnGroup.className='button-group';
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  const mkBtn = (txt, cls, val) => {
Â  Â  Â  Â  Â  Â  Â  Â  const b = document.createElement('button'); b.className=cls; b.textContent=txt;
Â  Â  Â  Â  Â  Â  Â  Â  b.onclick=()=>{Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // SAVE STATE FOR HISTORY
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  state.history.push(JSON.stringify({
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  answers: state.answers,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  asked: state.asked,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  currentSign: state.currentSign
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }));
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  state.answers[signe]=val;Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  askNextQuestion();Â 
Â  Â  Â  Â  Â  Â  Â  Â  };
Â  Â  Â  Â  Â  Â  Â  Â  btnGroup.appendChild(b);
Â  Â  Â  Â  Â  Â  };
Â  Â  Â  Â  Â  Â  mkBtn('OUI', 'btn btn-success', true);
Â  Â  Â  Â  Â  Â  mkBtn('NON', 'btn btn-error', false);
Â  Â  Â  Â  Â  Â  mkBtn('Je ne sais pas', 'link', null);
Â  Â  Â  Â  Â  Â  card.appendChild(btnGroup);

Â  Â  Â  Â  Â  Â  // NAV BUTTONS
Â  Â  Â  Â  Â  Â  const navGroup = document.createElement('div');
Â  Â  Â  Â  Â  Â  navGroup.style.display = 'flex';
Â  Â  Â  Â  Â  Â  navGroup.style.gap = '15px';
Â  Â  Â  Â  Â  Â  navGroup.style.marginTop = '20px';

Â  Â  Â  Â  Â  Â  // Back Button
Â  Â  Â  Â  Â  Â  if(state.history.length > 0) {
Â  Â  Â  Â  Â  Â  Â  Â  const btnBack = document.createElement('button');
Â  Â  Â  Â  Â  Â  Â  Â  btnBack.className='btn-back'; btnBack.textContent='â¬…ï¸ Retour';
Â  Â  Â  Â  Â  Â  Â  Â  btnBack.onclick = () => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const prevState = JSON.parse(state.history.pop());
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  state.answers = prevState.answers;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  state.asked = prevState.asked;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  state.currentSign = prevState.currentSign;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  renderCurrentQuestion();
Â  Â  Â  Â  Â  Â  Â  Â  };
Â  Â  Â  Â  Â  Â  Â  Â  navGroup.appendChild(btnBack);
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  const btnAb = document.createElement('button'); btnAb.className='link'; btnAb.textContent='Abandonner';Â 
Â  Â  Â  Â  Â  Â  btnAb.onclick=renderHome;
Â  Â  Â  Â  Â  Â  navGroup.appendChild(btnAb);
Â  Â  Â  Â  Â  Â  card.appendChild(navGroup);

Â  Â  Â  Â  Â  Â  app.appendChild(card);
Â  Â  Â  Â  }

Â  Â  Â  Â  function askNextQuestion() {
Â  Â  Â  Â  Â  Â  prepareSigns(); rankPathologies();
Â  Â  Â  Â  Â  Â  if(canShowDiagnostic()){ showDiagnostic(); return; }
Â  Â  Â  Â  Â  Â  const remaining = state.allSigns.filter(s => !state.asked.includes(s));
Â  Â  Â  Â  Â  Â  if(remaining.length===0){ showDiagnostic(); return; }
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  const signe = getNextSmartSign(state.ranked, remaining);
Â  Â  Â  Â  Â  Â  state.currentSign = signe; state.asked.push(signe);
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  renderCurrentQuestion();
Â  Â  Â  Â  }

Â  Â  Â  Â  function showDiagnostic() {
Â  Â  Â  Â  Â  Â  const app = q('#app');
Â  Â  Â  Â  Â  Â  app.innerHTML = '';
Â  Â  Â  Â  Â  Â  const loadingCard = document.createElement('div');
Â  Â  Â  Â  Â  Â  loadingCard.className = 'card center';
Â  Â  Â  Â  Â  Â  loadingCard.innerHTML = `
Â  Â  Â  Â  Â  Â  Â  Â  <h3 style="color:var(--accent)">ğŸ” Analyse IA en cours...</h3>
Â  Â  Â  Â  Â  Â  Â  Â  <div style="margin: 30px 0; font-size: 50px; animation: spin 0.8s infinite linear;">âš™ï¸</div>
Â  Â  Â  Â  Â  Â  Â  Â  <p class="small">Comparaison base de donnÃ©es...</p>
Â  Â  Â  Â  Â  Â  `;
Â  Â  Â  Â  Â  Â  app.appendChild(loadingCard);

Â  Â  Â  Â  Â  Â  setTimeout(() => {
Â  Â  Â  Â  Â  Â  Â  Â  rankPathologies();
Â  Â  Â  Â  Â  Â  Â  Â  const top = state.ranked[0];
Â  Â  Â  Â  Â  Â  Â  Â  state.diagnosticShown = true;
Â  Â  Â  Â  Â  Â  Â  Â  state.previousDiagnostics.push(top.patho.name);

Â  Â  Â  Â  Â  Â  Â  Â  app.innerHTML = '';Â 
Â  Â  Â  Â  Â  Â  Â  Â  const card = document.createElement('div'); card.className='card center';
Â  Â  Â  Â  Â  Â  Â  Â  const title = document.createElement('h2'); title.textContent='ğŸ’¡ Diagnostic ProposÃ©'; card.appendChild(title);
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  let pdfButton = top.patho.pdf && top.patho.pdf !== '#' ?Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  `<a class="link" style="color:var(--accent); border-color:var(--accent); display:inline-block; margin-top:10px;" href="${top.patho.pdf}" target="_blank">ğŸ“„ Voir fiche PDF</a>` :Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  `<span class="small" style="opacity:0.5">ğŸ“„ Pas de fiche PDF</span>`;
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  const diagDiv = document.createElement('div'); diagDiv.className='diagnostic-result';
Â  Â  Â  Â  Â  Â  Â  Â  diagDiv.innerHTML = `<div class="diagnostic-name">${top.patho.name}</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <div class="patho-desc" style="margin-top:8px">${top.patho.short}</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <div class="score-badge">ProbabilitÃ© : ${top.prob}%</div><br>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â ${pdfButton}`;
Â  Â  Â  Â  Â  Â  Â  Â  card.appendChild(diagDiv);
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  const btnGroup = document.createElement('div'); btnGroup.className='button-group';
Â  Â  Â  Â  Â  Â  Â  Â  const btnTrue = document.createElement('button'); btnTrue.className='btn btn-success'; btnTrue.textContent='âœ… Correct';
Â  Â  Â  Â  Â  Â  Â  Â  btnTrue.onclick = async () => {Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  triggerConfetti();
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  state.progression.correct++;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  await saveProgression();Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  showAlert('Diagnostic validÃ© !','success'); showDiagnosticDetails(top);
Â  Â  Â  Â  Â  Â  Â  Â  };
Â  Â  Â  Â  Â  Â  Â  Â  const btnFalse = document.createElement('button'); btnFalse.className='btn btn-error'; btnFalse.textContent='âŒ Incorrect';
Â  Â  Â  Â  Â  Â  Â  Â  btnFalse.onclick = async () => {Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  state.progression.incorrect++;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  await saveProgression();Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  showAlert('AÃ¯e... Continuons','error'); state.diagnosticShown=false; setTimeout(()=>askNextQuestion(), 800);
Â  Â  Â  Â  Â  Â  Â  Â  };
Â  Â  Â  Â  Â  Â  Â  Â  btnGroup.appendChild(btnTrue); btnGroup.appendChild(btnFalse); card.appendChild(btnGroup); app.appendChild(card);
Â  Â  Â  Â  Â  Â  }, 1500);
Â  Â  Â  Â  }

Â  Â  Â  Â  function showDiagnosticDetails(top) {
Â  Â  Â  Â  Â  Â  const app = q('#app'); app.innerHTML = '';
Â  Â  Â  Â  Â  Â  const card = document.createElement('div'); card.className='card';
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  const title = document.createElement('h2'); title.innerHTML = `âœ… ${top.patho.name}`; card.appendChild(title);
Â  Â  Â  Â  Â  Â  const desc = document.createElement('div'); desc.className='patho-desc'; desc.textContent = top.patho.short; desc.style.marginBottom='20px'; desc.style.textAlign='center'; card.appendChild(desc);
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  const pathoSigns = Object.keys(top.patho.signes);
Â  Â  Â  Â  Â  Â  const correctSigns = [], missingSigns = [], notAskedSigns = [], erroneousSigns = [];
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  pathoSigns.forEach(s => {
Â  Â  Â  Â  Â  Â  Â  Â  const val = state.answers[s];
Â  Â  Â  Â  Â  Â  Â  Â  if(val === true) correctSigns.push(s);Â 
Â  Â  Â  Â  Â  Â  Â  Â  else if(val === false) missingSigns.push(s);
Â  Â  Â  Â  Â  Â  Â  Â  else notAskedSigns.push(s);
Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  state.allSigns.forEach(s => {Â 
Â  Â  Â  Â  Â  Â  Â  Â  if(state.answers[s] === true && !pathoSigns.includes(s)) erroneousSigns.push(s);Â 
Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  const resultsDiv = document.createElement('div'); resultsDiv.className='result-list';
Â  Â  Â  Â  Â  Â  const createList = (title, items, type, typeLabel) => {
Â  Â  Â  Â  Â  Â  Â  Â  if(items.length > 0) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const h = document.createElement('h4');Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  h.textContent = `${title} (${items.length})`;Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  h.style.marginTop='15px'; h.style.marginBottom='5px'; h.style.color='white';Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  resultsDiv.appendChild(h);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  items.forEach(s => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const r = document.createElement('div'); r.className='result-item result-'+type;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  r.innerHTML = `<div>${formatSigneName(s)}</div><div style="opacity:0.7; font-size:0.85em; font-weight:600;">${typeLabel}</div>`;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  resultsDiv.appendChild(r);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  };
Â  Â  Â  Â  Â  Â  createList("âœ… Signes bien identifiÃ©s", correctSigns, "correct", "ValidÃ©");
Â  Â  Â  Â  Â  Â  createList("âŒ Signes manquÃ©s (Faux NÃ©gatifs)", missingSigns, "missing", "Vous avez dit Non");
Â  Â  Â  Â  Â  Â  createList("â„¹ï¸ Autres signes du tableau clinique", notAskedSigns, "neutral", "Non demandÃ©");
Â  Â  Â  Â  Â  Â  createList("âš ï¸ Signes cochÃ©s Ã  tort (Faux Positifs)", erroneousSigns, "error", "Erreur");
Â  Â  Â  Â  Â  Â  card.appendChild(resultsDiv);
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  const btnGroup = document.createElement('div'); btnGroup.className='button-group';
Â  Â  Â  Â  Â  Â  const btnHome = document.createElement('button'); btnHome.className='btn'; btnHome.textContent = 'ğŸ  Retour Accueil'; btnHome.onclick = renderHome;
Â  Â  Â  Â  Â  Â  btnGroup.appendChild(btnHome); card.appendChild(btnGroup); app.appendChild(card);
Â  Â  Â  Â  }

Â  Â  Â  Â  // =================== GLOSSARY FUNCTION ===================
Â  Â  Â  Â  function renderGlossary() {
Â  Â  Â  Â  Â  Â  const app = q('#app'); app.innerHTML='';
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  // 1. Header
Â  Â  Â  Â  Â  Â  const titleCard = document.createElement('div'); titleCard.className='card center'; titleCard.innerHTML='<h2>ğŸ“š Glossaire</h2>';Â 
Â  Â  Â  Â  Â  Â  const btnBack = document.createElement('button'); btnBack.className='link'; btnBack.textContent='ğŸ  Retour';
Â  Â  Â  Â  Â  Â  btnBack.style.marginBottom='20px'; btnBack.onclick=renderHome;
Â  Â  Â  Â  Â  Â  titleCard.appendChild(btnBack);
Â  Â  Â  Â  Â  Â  app.appendChild(titleCard);

Â  Â  Â  Â  Â  Â  // 2. Search Container
Â  Â  Â  Â  Â  Â  const searchContainer = document.createElement('div');
Â  Â  Â  Â  Â  Â  searchContainer.className = 'search-container';
Â  Â  Â  Â  Â  Â  const searchInput = document.createElement('input');
Â  Â  Â  Â  Â  Â  searchInput.className = 'search-input';
Â  Â  Â  Â  Â  Â  searchInput.placeholder = 'ğŸ” Rechercher une pathologie (ex: Grippe...)';
Â  Â  Â  Â  Â  Â  searchInput.type = 'text';
Â  Â  Â  Â  Â  Â  searchContainer.appendChild(searchInput);
Â  Â  Â  Â  Â  Â  app.appendChild(searchContainer);

Â  Â  Â  Â  Â  Â  // 3. Wrapper Structure
Â  Â  Â  Â  Â  Â  const wrapper = document.createElement('div'); wrapper.className = 'glossary-wrapper';
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  // --- SIDEBAR ---
Â  Â  Â  Â  Â  Â  const sidebar = document.createElement('div'); sidebar.className = 'alphabet-sidebar';
Â  Â  Â  Â  Â  Â  const alphabet = "ABCDEFGHIJKLMNOPQRSTUVWXYZ".split("");
Â  Â  Â  Â  Â  Â  const sortedPathos = [...PATHOLOGIES].sort((a, b) => a.name.localeCompare(b.name));
Â  Â  Â  Â  Â  Â  const existingLetters = new Set(sortedPathos.map(p => p.name.charAt(0).toUpperCase()));
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  alphabet.forEach(letter => {
Â  Â  Â  Â  Â  Â  Â  Â  const link = document.createElement('a');
Â  Â  Â  Â  Â  Â  Â  Â  link.textContent = letter;
Â  Â  Â  Â  Â  Â  Â  Â  link.className = 'alpha-link';
Â  Â  Â  Â  Â  Â  Â  Â  if (existingLetters.has(letter)) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  link.href = `#letter-${letter}`;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  link.onclick = (e) => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  e.preventDefault();
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const target = document.getElementById(`letter-${letter}`);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if(target) target.scrollIntoView({behavior: 'smooth', block: 'start'});
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  };
Â  Â  Â  Â  Â  Â  Â  Â  } else { link.classList.add('disabled'); }
Â  Â  Â  Â  Â  Â  Â  Â  sidebar.appendChild(link);
Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  wrapper.appendChild(sidebar);

Â  Â  Â  Â  Â  Â  // --- CONTENT ---
Â  Â  Â  Â  Â  Â  const content = document.createElement('div'); content.className = 'glossary-content';
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  function renderGrid(pathos, showHeaders = true) {
Â  Â  Â  Â  Â  Â  Â  Â  content.innerHTML = '';
Â  Â  Â  Â  Â  Â  Â  Â  if(pathos.length === 0) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  content.innerHTML = '<div style="text-align:center; padding:20px; color:var(--text-muted)">Aucune pathologie trouvÃ©e.</div>';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  Â  Â  if(!showHeaders) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const grid = document.createElement('div'); grid.className = 'letter-grid';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  pathos.forEach(p => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const card = createPathoCard(p);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  grid.appendChild(card);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  content.appendChild(grid);
Â  Â  Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  alphabet.forEach(letter => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const letterPathos = pathos.filter(p => p.name.charAt(0).toUpperCase() === letter);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if(letterPathos.length > 0) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const letterHeader = document.createElement('div');
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  letterHeader.className = 'letter-header';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  letterHeader.id = `letter-${letter}`;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  letterHeader.textContent = letter;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  content.appendChild(letterHeader);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const grid = document.createElement('div'); grid.className = 'letter-grid';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  letterPathos.forEach(p => { grid.appendChild(createPathoCard(p)); });
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  content.appendChild(grid);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  function createPathoCard(p) {
Â  Â  Â  Â  Â  Â  Â  Â  const card = document.createElement('div'); card.className='patho-card';
Â  Â  Â  Â  Â  Â  Â  Â  card.innerHTML=`<div class="patho-name">${p.name}</div><div class="patho-desc">${p.short}</div>`;
Â  Â  Â  Â  Â  Â  Â  Â  card.onclick=()=>{Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if(p.pdf && p.pdf !== '#') window.open(p.pdf,'_blank');Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  else showAlert('Fiche PDF non disponible','error');Â 
Â  Â  Â  Â  Â  Â  Â  Â  };
Â  Â  Â  Â  Â  Â  Â  Â  return card;
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  // Initial Render
Â  Â  Â  Â  Â  Â  renderGrid(sortedPathos, true);

Â  Â  Â  Â  Â  Â  // Search Logic
Â  Â  Â  Â  Â  Â  searchInput.addEventListener('input', (e) => {
Â  Â  Â  Â  Â  Â  Â  Â  const term = e.target.value.toLowerCase();
Â  Â  Â  Â  Â  Â  Â  Â  if(term.length > 0) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  sidebar.style.display = 'none'; // Hide A-Z on search
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const filtered = sortedPathos.filter(p => p.name.toLowerCase().includes(term));
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  renderGrid(filtered, false); // Flat grid without headers
Â  Â  Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  sidebar.style.display = 'flex';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  renderGrid(sortedPathos, true);
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  wrapper.appendChild(content);
Â  Â  Â  Â  Â  Â  app.appendChild(wrapper);
Â  Â  Â  Â  }
Â  Â  </script>
</body>
</html>
